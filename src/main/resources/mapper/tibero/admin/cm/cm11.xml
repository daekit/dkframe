<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.dksys.biz.admin.cm.cm11.mapper.CM11Mapper">

	<select id="selectPrdtSelpch2Count" resultType="int">
	  SELECT COUNT(*)
	  FROM (SELECT TRST_PRDT_CD,
		   (SELECT PRDT_NM FROM TB_BM01M01 WHERE PRDT_CD = T.TRST_PRDT_CD) AS PRDT_NM,
		   SUM(TRST_QTY) TRST_QTY,
		   SUM(REAL_TRST_QTY)  REAL_TRST_QTY,
		   SUM(TRST_AMT) TRST_AMT,
		   SUM(REAL_TRST_AMT) REAL_TRST_AMT
	  FROM TB_AR02M01 T
	 WHERE SUBSTRING(TRST_DT, 0, 6) = TO_CHAR(SYSDATE, 'YYYYMM')
	   AND SELPCH_CD = 'SELPCH2'
	 GROUP BY TRST_PRDT_CD)
	</select>
	
	<select id="selectPrdtSelpch2List" resultType="CamelMap">
	SELECT TRST_PRDT_CD,
		   (SELECT PRDT_NM FROM TB_BM01M01 WHERE PRDT_CD = T.TRST_PRDT_CD) AS PRDT_NM,
		   SUM(TRST_QTY) TRST_QTY,
		   SUM(REAL_TRST_QTY)  REAL_TRST_QTY,
		   SUM(TRST_AMT) TRST_AMT,
		   SUM(REAL_TRST_AMT) REAL_TRST_AMT
	  FROM TB_AR02M01 T
	 WHERE SUBSTRING(TRST_DT, 0, 6) = TO_CHAR(SYSDATE, 'YYYYMM')
	   AND SELPCH_CD = 'SELPCH2'
	 GROUP BY TRST_PRDT_CD
  ORDER BY TRST_PRDT_CD
	</select>
	
	<select id="selectClntSelpch2Count" resultType="int">
	SELECT COUNT(*)
	  FROM (SELECT TRST_CLNT_CD,
		   (SELECT CLNT_NM FROM TB_BM02M01 WHERE CLNT_CD = T.TRST_CLNT_CD) CLNT_NM,
		   SUM(TRST_QTY) TRST_QTY,
		   SUM(REAL_TRST_QTY)  REAL_TRST_QTY,
		   SUM(TRST_AMT) TRST_AMT,
		   SUM(REAL_TRST_AMT) REAL_TRST_AMT
	  FROM TB_AR02M01 T
	 WHERE SUBSTRING(TRST_DT, 0, 6) = TO_CHAR(SYSDATE, 'YYYYMM')
	   AND SELPCH_CD = 'SELPCH2'
	 GROUP BY TRST_CLNT_CD
  ORDER BY TRST_CLNT_CD)
	</select>
	
	<select id="selectClntSelpch2List" resultType="CamelMap">
	SELECT TRST_CLNT_CD,
		   (SELECT CLNT_NM FROM TB_BM02M01 WHERE CLNT_CD = T.TRST_CLNT_CD) CLNT_NM,
		   SUM(TRST_QTY) TRST_QTY,
		   SUM(REAL_TRST_QTY)  REAL_TRST_QTY,
		   SUM(TRST_AMT) TRST_AMT,
		   SUM(REAL_TRST_AMT) REAL_TRST_AMT
	  FROM TB_AR02M01 T
	 WHERE SUBSTRING(TRST_DT, 0, 6) = TO_CHAR(SYSDATE, 'YYYYMM')
	   AND SELPCH_CD = 'SELPCH2'
	 GROUP BY TRST_CLNT_CD
  ORDER BY TRST_CLNT_CD
	</select>
	
	<select id="selectClntSelpch1Count" resultType="int">
	SELECT COUNT(*)
	  FROM (SELECT TRST_CLNT_CD,
		   (SELECT CLNT_NM FROM TB_BM02M01 WHERE CLNT_CD = T.TRST_CLNT_CD) CLNT_NM,
		   TRST_PRDT_CD,
		   (SELECT PRDT_NM FROM TB_BM01M01 WHERE PRDT_CD = T.TRST_PRDT_CD) AS PRDT_NM,
		   SUM(TRST_QTY) TRST_QTY,
		   SUM(REAL_TRST_QTY)  REAL_TRST_QTY,
		   SUM(TRST_AMT) TRST_AMT,
		   SUM(REAL_TRST_AMT) REAL_TRST_AMT
	  FROM TB_AR02M01 T
	 WHERE SUBSTRING(TRST_DT, 0, 6) = TO_CHAR(SYSDATE, 'YYYYMM')
	   AND SELPCH_CD = 'SELPCH1'
	 GROUP BY TRST_CLNT_CD
	 		, TRST_PRDT_CD
  ORDER BY TRST_CLNT_CD)
	</select>
	
	<select id="selectClntSelpch1List" resultType="CamelMap">
	SELECT TRST_CLNT_CD,
		   (SELECT CLNT_NM FROM TB_BM02M01 WHERE CLNT_CD = T.TRST_CLNT_CD) CLNT_NM,
		   TRST_PRDT_CD,
		   (SELECT PRDT_NM FROM TB_BM01M01 WHERE PRDT_CD = T.TRST_PRDT_CD) AS PRDT_NM,
		   SUM(TRST_QTY) TRST_QTY,
		   SUM(REAL_TRST_QTY)  REAL_TRST_QTY,
		   SUM(TRST_AMT) TRST_AMT,
		   SUM(REAL_TRST_AMT) REAL_TRST_AMT
	  FROM TB_AR02M01 T
	 WHERE SUBSTRING(TRST_DT, 0, 6) = TO_CHAR(SYSDATE, 'YYYYMM')
	   AND SELPCH_CD = 'SELPCH1'
	 GROUP BY TRST_CLNT_CD
	 		, TRST_PRDT_CD
  ORDER BY TRST_CLNT_CD
	</select>
</mapper>