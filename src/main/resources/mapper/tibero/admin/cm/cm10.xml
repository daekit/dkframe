<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.dksys.biz.admin.cm.cm10.mapper.CM10Mapper">

	<select id="selectShipNCount" resultType="int">
	SELECT COUNT(*)
	  FROM TB_AR01M01 A
	 WHERE A.SHIP_YN = 'N'
	</select>
	
	<select id="selectShipNList" resultType="CamelMap">
	SELECT A.CO_CD
		 , TO_CHAR(TO_DATE(A.REQ_DT, 'YYYYMMDD'), 'YYYY-MM-DD') REQ_DT
		 , A.CLNT_CD
		 , (SELECT CLNT_NM FROM TB_BM02M01 WHERE CLNT_CD = A.CLNT_CD) CLNT_NM
		 , A.SHIP_SEQ
		 , (SELECT PRJCT_NM FROM TB_SD05M01 WHERE PRJCT_CD = A.PRJCT_CD) AS PRJCT_NM
		 , A.PRJCT_CD
		 , A.MAKR_CD
		 , A.WH_CD
		 , FN_CM05M01_CD_TO_NM(A.WH_CD) WH_NM
		 , A.TYP_CD
		 , A.OWNER_CD
		 , A.IMP_YN
		 , A.SALES_AREA_CD
		 , A.MNG_TEL
		 , A.DLVR_DTTM
		 , A.DIRTRS_YN
		 , A.DLVR_RMK
		 , A.ADDR_ZIP
		 , A.ADDR_MAIN
		 , A.ADDR_SUB
		 , A.SHIP_RMK
		 , SUM(B.SHIP_QTY) SHIP_TOT_QTY
		 , A.SHIP_TOT_WT
		 , A.SHIP_TOT_AMT
		 , SUM(DECODE(B.SHIP_YN , 'N', B.REAL_SHIP_QTY)) REAL_TOT_QTY
		 , SUM(B.SHIP_QTY) - SUM(DECODE(B.SHIP_YN , 'N', B.REAL_SHIP_QTY)) REMAIN_QTY
		 , A.REAL_TOT_WT
		 , A.REAL_TOT_AMT
		 , A.TRANS_AMT
		 , A.ODR_SEQ
		 , A.ORDRG_SEQ
		 , A.SALES_MNG
		 , A.RECPT_YN
		 , A.SHIP_YN
		 , A.SHIP_PROC_ID
		 , A.SHIP_DTTM
		 , A.ODR_CREAT_DIV
	  FROM TB_AR01M01 A
	     , TB_AR01D01 B
	 WHERE A.SHIP_YN = 'N'
	   AND A.SHIP_SEQ = B.SHIP_SEQ
	   GROUP BY A.CO_CD
			, A.REQ_DT
			, A.CLNT_CD
			, A.SHIP_SEQ
			, A.PRJCT_CD
			, A.MAKR_CD
			, A.WH_CD
			, A.TYP_CD
			, A.OWNER_CD
			, A.IMP_YN
			, A.SALES_AREA_CD
			, A.MNG_TEL
			, A.DLVR_DTTM
			, A.DIRTRS_YN
			, A.DLVR_RMK
			, A.ADDR_ZIP
			, A.ADDR_MAIN
			, A.ADDR_SUB
			, A.SHIP_RMK
			, A.SHIP_TOT_QTY
			, A.SHIP_TOT_WT
			, A.SHIP_TOT_AMT
			, A.REAL_TOT_QTY
			, A.REAL_TOT_WT
			, A.REAL_TOT_AMT
			, A.TRANS_AMT
			, A.ODR_SEQ
			, A.ORDRG_SEQ
			, A.SALES_MNG
			, A.RECPT_YN
			, A.SHIP_YN
			, A.SHIP_PROC_ID
			, A.SHIP_DTTM
			, A.ODR_CREAT_DIV
  ORDER BY A.REQ_DT, A.SHIP_SEQ
	</select>
	
	<select id="selectOrdrgNCount" resultType="int">
	SELECT COUNT(*)
		  FROM TB_OD01M01 A
		 WHERE A.ORDRG_YN = 'N'
	</select>
	
	<select id="selectOrdrgNList" resultType="CamelMap">
	SELECT A.CO_CD
		 , TO_CHAR(TO_DATE(A.REQ_DT, 'YYYYMMDD'), 'YYYY-MM-DD') REQ_DT
		 , (SELECT CLNT_NM FROM TB_BM02M01 WHERE CLNT_CD = A.CLNT_CD) CLNT_NM
		 , A.CLNT_CD
		 , A.ORDRG_SEQ
		 , (SELECT PRJCT_NM FROM TB_SD05M01 WHERE PRJCT_CD = A.PRJCT_CD) AS PRJCT_NM
		 , A.PRJCT_CD
		 , A.MAKR_CD
		 , FN_CM05M01_CD_TO_NM(A.WH_CD) WH_NM
		 , A.WH_CD
		 , A.TYP_CD
		 , A.OWNER_CD
		 , A.IMP_YN
		 , A.SALES_AREA_CD
		 , A.SELL_CLNT_CD
		 , A.MNG_TEL
		 , A.DLVR_DTTM
		 , A.DLVR_RMK
		 , A.DIRTRS_YN
		 , A.ADDR_ZIP
		 , A.ADDR_MAIN
		 , A.ADDR_SUB
		 , A.ORDRG_RMK
		 , A.TOT_QTY
		 , A.TOT_WT
		 , A.TOT_AMT
		 , A.TRANS_AMT
		 , A.ODR_SEQ
		 , A.PCHS_NO
		 , A.SALES_MNG
		 , A.ORDRG_YN
		 , A.ORDRG_PROC_ID
		 , A.ORDRG_PROC_DTTM
		 , A.ODR_CREAT_DIV
		 , SUM(B.ORDRG_QTY) ORDRG_QTY
		 , SUM(DECODE(B.ORDRG_YN, 'N', B.REAL_DLVR_QTY)) REAL_DLVR_QTY
		 , SUM(B.ORDRG_QTY) - SUM(DECODE(B.ORDRG_YN, 'N', B.REAL_DLVR_QTY)) REMAIN_QTY
	  FROM TB_OD01M01 A
	     , TB_OD01D01 B
	 WHERE A.ORDRG_SEQ = B.ORDRG_SEQ
	   AND A.ORDRG_YN = 'N'
	   GROUP BY A.CO_CD
			 , A.REQ_DT
			 , A.CLNT_CD
			 , A.ORDRG_SEQ
			 , A.PRJCT_CD
			 , A.MAKR_CD
			 , A.WH_CD
			 , A.TYP_CD
			 , A.OWNER_CD
			 , A.IMP_YN
			 , A.SALES_AREA_CD
			 , A.SELL_CLNT_CD
			 , A.MNG_TEL
			 , A.DLVR_DTTM
			 , A.DLVR_RMK
			 , A.DIRTRS_YN
			 , A.ADDR_ZIP
			 , A.ADDR_MAIN
			 , A.ADDR_SUB
			 , A.ORDRG_RMK
			 , A.TOT_QTY
			 , A.TOT_WT
			 , A.TOT_AMT
			 , A.TRANS_AMT
			 , A.ODR_SEQ
			 , A.PCHS_NO
			 , A.SALES_MNG
			 , A.ORDRG_YN
			 , A.ORDRG_PROC_ID
			 , A.ORDRG_PROC_DTTM
			 , A.ODR_CREAT_DIV
			 ORDER BY REQ_DT, ORDRG_SEQ
	</select>
</mapper>