<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">    
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <link rel="icon" href="/static/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="/static/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/static/bootstrap/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="/static/bootstrap/css/dashboard.css">
    <link rel="stylesheet" href="/static/bootstrap/css/bootstrap-datepicker.css">
    <link rel="stylesheet" href="/static/fontawesome/css/all.css">
    <link rel="stylesheet" href="/static/css/ax5/ax5grid.css" />
    <link rel="stylesheet" href="/static/css/ax5/ax5mask.css" />
    <link rel="stylesheet" href="/static/css/ax5/ax5modal.css" />
    <link rel="stylesheet" href="/static/css/ax5/ax5toast.css" />
    <link rel="stylesheet" href="/static/css/jstree/style.min.css" />
    <link rel="stylesheet" href="/static/css/gnb.css" />
    <link rel="stylesheet" href="/static/css/main.css" />
    <link rel="stylesheet" href="/static/css/sub.css" />
    <link rel="stylesheet" href="/static/css/common.css" />
	<link rel="stylesheet" href="/static/css/mobile.css" />

    <script src="/static/js/jquery-latest.min.js"></script>
    <script src="/static/js/jquery.serializeObject.js"></script>
    <script src="/static/bootstrap/js/bootstrap.min.js"></script>
    <script src="/static/bootstrap/js/bootstrap-datepicker.min.js"></script>
    <script src="/static/bootstrap/js/bootstrap-datepicker.ko.min.js"></script>
    <script src="/static/js/moment/moment-with-locales.js"></script>
    <script src="/static/js/ax5/ax5core.min.js"></script>
    <script src="/static/js/ax5/ax5grid.min.js"></script>
    <script src="/static/js/ax5/ax5mask.min.js"></script>
    <script src="/static/js/ax5/ax5modal.min.js"></script>
    <script src="/static/js/ax5/ax5toast.min.js"></script>
    <script src="/static/js/jstree/jstree.min.js"></script>
    <script src="/static/js/global.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
</head>

<body>
	<div id="head_area" class="off" >
		<div class="left_btn" onclick="history.back(-1)">
      		<a class="back_btn"></a>
    	</div>
		<h1 class="logo">
      		<img src="/static/img/Logo.png" alt="금문철강" /> 
    	</h1>		
	</div>

    <div id="main_area">

		<div class="contents search">
			<table class="table_input">
					<tr>
						<th style="text-align:right;">
							자료선택
						</th>
						<td colspan="1">
							<select id="searchItem" name="searchItem" data-search="searchItem" onchange="gridView2.setData();">
								<option value="S1">영업이익</option>
								<option value="S2" selected>매출액</option>
								<option value="S3">매출이익</option>
								<option value="S4">판매관리비</option>
								<option value="S5">세전이익</option>
							</select>
						</td>
						<th style="text-align:right;">
							단위
						</th>
						<td>
							<select id="searchUnit1" name="searchUnit1" data-search="searchItem" onchange="gridView2.setData();">
								<option value="100000000" selected>억원</option>
								<option value="1000000">백만원</option>
								<option value="1000">천원</option>
								<option value="1">원</option>
							</select>
						</td>
					</tr>
					<tr>
						<th  style="text-align:right;">그래프종류</th>
						<td colspan="1"> 
							<select name="chartOption" onchange="gridView2.setData();" >
								<option value="line" selected >선으로 보기</option>
								<option value="column">막대로 보기</option>						
							</select>
	 					 <!-- <input type="hidden" id="searchYear" name="searchYear" data-search="searchYear"> -->
						</td>
 						<th style="text-align:right;">조회 일자</th>
 						<td>
 							<select id="searchYear" name="searchYear" data-search="searchYear" onchange="gridView2.setData();">
 							</select>
 						</td>
 						<!-- 
 						<td>
 							<select id="searchMonth" name="searchMonth" data-search="searchMonth" onchange="gridView2.setData();">
 							</select>
 						</td>
 						 -->
					</tr>
				<tbody  class="container-fluid" id="chartOptionView">
				</tbody>
			</table>
		</div>

		<!-- 매출이익 start -->
		<div id='headerView2' style="display: none;">
			<div class="contents search">
				<table class="table_input ">
					<tr>
						<th>
							자료선택
						</th>
						<td colspan="1">
							<select id="searchItem2" name="searchItem2" data-search="searchItem2" onchange="gridView2.setData();">
								<option value="S1">영업이익</option>
								<option value="S2">매출액</option>
								<option value="S3">매출이익</option>
								<option value="S4">판매관리비</option>
								<option value="S5" selected>세전이익</option>
							</select>
						</td>
						<th>
							단위
						</th>
						<td>
							<select id="searchUnit2" name="searchUnit2" data-search="searchItem2" onchange="gridView2.setData();">
								<option value="100000000" selected>억원</option>
								<option value="1000000" selected>백만원</option>
								<option value="1000">천원</option>
								<option value="1">원</option>
							</select>
						</td>
					</tr>
				</table>
			</div>


		</div>

        <div id="contentView1">
            <div id="chart_div5" style="display:inline-block; margin: 0 auto; text-align:left;"></div>
        </div>

        <div>
            <table class="form-group popup_table" id="contentView2">
                <thead>                  
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <div class="" style="margin:0px;padding:0px;">
                                <div data-ax5grid="grid01" data-ax5grid-config="{}" style="height:150px;">
                                </div>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div id="chart_div1"></div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="form-group popup_table" id="contentView3" style="display: none;">
                <thead>                 
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <div class="" style="margin:0px;padding:0px;width:100%;">
                                <div data-ax5grid="grid02" data-ax5grid-config="{}" style="height:150px; width: 100%">
                                </div>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div id="chart_div2"></div>
                        </td>
                    </tr>
                </tbody>
            </table>

        </div>


        <!-- 그래프 표시 end -->
    </div>
</body>

<script type="text/javascript">

    var chartData0;
    var chartData1;
    var chartData2;

    var gridView = {
		initView : function() {
			this.target = new ax5.ui.grid();
			this.target.setConfig({
				showRowSelector : false,
				multipleSelect : false,
				sortable : true,
				target : $('[data-ax5grid="grid01"]'),
				header : {
					align : "center",
					selector : false
				},
				body : {

				},
				page : {
					display : false
				},
				footSum: [
			    	[
			    		{label: "합계", align:"center"},
	                    {key: "tot",     collector: "sum", formatter:"money", align: "right"},
	                    {key: "1",     collector: "sum", formatter:"money", align: "right"},
	                    {key: "2", collector: "sum", formatter:"money", align: "right"},
	                    {key: "3", collector: "sum", formatter:"money", align: "right"},
	                    {key: "4", collector: "sum", formatter:"money", align: "right"},
	                    {key: "5", collector: "sum", formatter:"money", align: "right"},
	                    {key: "6", collector: "sum", formatter:"money", align: "right"},
	                    {key: "7", collector: "sum", formatter:"money", align: "right"},
	                    {key: "8", collector: "sum", formatter:"money", align: "right"},
	                    {key: "9", collector: "sum", formatter:"money", align: "right"},
	                    {key: "10", collector: "sum", formatter:"money", align: "right"},
	                    {key: "11", collector: "sum", formatter:"money", align: "right"},
	                    {key: "12", collector: "sum", formatter:"money", align: "right"}
			    	]
			    ],
				columns: [
		          	{key: "coNm",     label: "회사",   	align: "left", width: 80},
		          	{key: "tot",     label: "누계",   	formatter:"money", align: "right",  width: 80},
		          	{key: "1",       label: "1월",   	formatter:"money", align: "right",  width: 80},
		          	{key: "2",   label: "2월",    formatter:"money", align: "right",  width: 80},
		          	{key: "3",   label: "3월",    formatter:"money", align: "right",  width: 80},
		          	{key: "4",   label: "4월",    formatter:"money", align: "right",  width: 80},
		          	{key: "5",   label: "5월",    formatter:"money", align: "right",  width: 80},
		          	{key: "6",   label: "6월",    formatter:"money", align: "right",  width: 80},
		          	{key: "7",   label: "7월",    formatter:"money", align: "right",  width: 80},
		          	{key: "8",   label: "8월",    formatter:"money", align: "right",  width: 80},
		          	{key: "9",   label: "9월",    formatter:"money", align: "right",  width: 80},
		          	{key: "10",   label: "10월",    formatter:"money", align: "right",  width: 80},
		          	{key: "11",   label: "11월",    formatter:"money", align: "right",  width: 80},
		          	{key: "12",   label: "12월",    formatter:"money", align: "right",  width: 80},
		        ]
			});
			return this;
		}
	}
var gridView2 = {
		initView : function() {
			this.target = new ax5.ui.grid();
			this.target.setConfig({
				showRowSelector : false,
				multipleSelect : false,
				sortable : true,
				target : $('[data-ax5grid="grid02"]'),
				header : {
					align : "center",
					selector : false
				},
				body : {

				},
				page : {
					display : false
				},
				footSum: [
			    	[
			    		{label: "합계", align:"center"},
	                    {key: "tot",   collector: "sum", formatter:"money", align: "right"},
	                    {key: "1",     collector: "sum", formatter:"money", align: "right"},
	                    {key: "2", collector: "sum", formatter:"money", align: "right"},
	                    {key: "3", collector: "sum", formatter:"money", align: "right"},
	                    {key: "4", collector: "sum", formatter:"money", align: "right"},
	                    {key: "5", collector: "sum", formatter:"money", align: "right"},
	                    {key: "6", collector: "sum", formatter:"money", align: "right"},
	                    {key: "7", collector: "sum", formatter:"money", align: "right"},
	                    {key: "8", collector: "sum", formatter:"money", align: "right"},
	                    {key: "9", collector: "sum", formatter:"money", align: "right"},
	                    {key: "10", collector: "sum", formatter:"money", align: "right"},
	                    {key: "11", collector: "sum", formatter:"money", align: "right"},
	                    {key: "12", collector: "sum", formatter:"money", align: "right"}
			    	]
			    ],
				columns: [
		          	{key: "coNm",     label: "회사",   	align: "left", width: 80},
		          	{key: "tot",       label: "누계",   	formatter:"money", align: "right",  width: 80},
		          	{key: "1",       label: "1월",   	formatter:"money", align: "right",  width: 80},
		          	{key: "2",   label: "2월",    formatter:"money", align: "right",  width: 80},
		          	{key: "3",   label: "3월",    formatter:"money", align: "right",  width: 80},
		          	{key: "4",   label: "4월",    formatter:"money", align: "right",  width: 80},
		          	{key: "5",   label: "5월",    formatter:"money", align: "right",  width: 80},
		          	{key: "6",   label: "6월",    formatter:"money", align: "right",  width: 80},
		          	{key: "7",   label: "7월",    formatter:"money", align: "right",  width: 80},
		          	{key: "8",   label: "8월",    formatter:"money", align: "right",  width: 80},
		          	{key: "9",   label: "9월",    formatter:"money", align: "right",  width: 80},
		          	{key: "10",   label: "10월",    formatter:"money", align: "right",  width: 80},
		          	{key: "11",   label: "11월",    formatter:"money", align: "right",  width: 80},
		          	{key: "12",   label: "12월",    formatter:"money", align: "right",  width: 80},
		        ]
			});
			return this;
		},
		setData : function() {
			var paramObj = {
					"searchItem"	: $('#searchItem').val(),
					"searchItem2"	: $('#searchItem2').val(),
					"searchUnit1"	: $('#searchUnit1').val(),
					"searchUnit2"	: $('#searchUnit2').val(),
					"searchYear" 	: $('#searchYear').val()
					// ,"searchMonth" 	: $('#searchMonth').val()
			};
			console.log("setData test !!!!!!!!!!!");
			postAjax(DOMAIN_URL + "/user/fi/fi02/selectPalBillStat", paramObj, null, function(data) {
				console.log(data);
				gridView.target.setData({
					list : data.resultList1,
					page : {
					}
				});
				gridView2.target.setData({
					list : data.resultList2,
					page : {
					}
				});
				google.charts.setOnLoadCallback(function drawChart(){
					chartData1 = new google.visualization.DataTable(data.chartData1);      
					chartData2 = new google.visualization.DataTable(data.chartData2);    
					setChart();
				});	
			});		
		}
	}
	
	function setChart(){
		console.log('setChart = ' + $("[name=chartOption]").val());
		if($("[name=chartOption]").val() == "line"){
			var chart1 = new google.visualization.LineChart(document.getElementById("chart_div1"));      
			var chart2 = new google.visualization.LineChart(document.getElementById("chart_div2"));     
	
			var options = {
					height : 500,
				    fontSize: '10',
				    //curveType: 'function',
				    animation: { //차트가 뿌려질때 실행될 애니메이션 효과
		                 startup: true,
		                 duration: 1000,
		                 easing: 'linear' }				                 
			}
			chart1.draw(chartData1, options);
			chart2.draw(chartData2, options);
		} else if($("[name='chartOption']").val() == "column"){
			var chart1 = new google.visualization.ColumnChart(document.getElementById("chart_div1"));      
			var chart2 = new google.visualization.ColumnChart(document.getElementById("chart_div2"));     
	
			var options = {
					height : 500,
				    fontSize: '10',
				    //curveType: 'function',
				    isStacked:true,
				    animation: { //차트가 뿌려질때 실행될 애니메이션 효과
		                 startup: true,
		                 duration: 1000,
		                 easing: 'linear' }				                 
			}
			chart1.draw(chartData1, options);
			chart2.draw(chartData2, options);
		}
	}	


    $(document).ready(function () {

    	SetYm();
    	/*
		var now = new Date();
		var nyear = now.getFullYear();
		$('#searchYear').val(nyear);
    	*/
// 		$("#searchDttm").val(dateToStr(new Date()));
// 		년월 select 세팅
// 		SetYm();

//         페이지 타이틀 set
//         mainDefaultLoad("대시보드", "임원진 현황");
//         grid init		
//         reqChartData0();
		gridView.initView();
		gridView2.initView().setData();
		var setDataInterval = setInterval(function() {
			chartSeq++;
			if(chartSeq % 2 == 0){
				$("#chartLine").prop("checked", true);
			} else {
				$("#chartColumn").prop("checked", true);
			}
			gridView2.initView().setData();
		}, 6000000);
	});
	
	google.charts.load('current', {'packages':['corechart']});
	
	function SetYm(){
			var now = new Date();
			var nyear = now.getFullYear();
			var nmon =  (now.getMonth()+1) > 9 ? ''+(now.getMonth()+1) : '0'+(now.getMonth()+1);
			
			for(var sy = 1900; sy <= nyear; sy++){
				$("#searchYear").append("<option value='" + sy + "'>" + sy + "년</option>");
			}
			
			for(var i=1; i <= 12; i++){
				var sm = i > 9 ? i : "0" + i;
				$("#searchMonth").append("<option value='" + sm + "'>" + i + "월</option>");
			}

			$("#searchYear option[value=" + nyear +"]").attr("selected", true);
			$("#searchMonth option[value=" + nmon +"]").attr("selected", true);
		};

</script>

</html>