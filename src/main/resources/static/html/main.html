<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/static/css/bootstrap/bootstrap.min.css">
	<link rel="stylesheet" href="/static/css/bootstrap/bootstrap-theme.min.css">
	<link rel="stylesheet" href="/static/css/bootstrap/dashboard.css">
	<link rel="stylesheet" href="/static/css/ax5/ax5grid.css" />
	<link rel="stylesheet" href="/static/css/ax5/ax5mask.css" />
	<link rel="stylesheet" href="/static/css/ax5/ax5modal.css" />
	<script src="/static/js/jquery-3.5.1.min.js"></script>
	<script src="/static/js/bootstrap/bootstrap.min.js"></script>
	<script src="/static/js/global.js"></script>
	<script src="/static/js/ax5/ax5core.min.js"></script>
	<script src="/static/js/ax5/ax5grid.min.js"></script>
	<script src="/static/js/ax5/ax5mask.min.js"></script>
	<script src="/static/js/ax5/ax5modal.min.js"></script>
  </head>
  <body>

    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">DK 프레임워크</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="#">Dashboard</a></li>
            <li><a href="#">Settings</a></li>
            <li><a href="#">Profile</a></li>
            <li><a href="#">Help</a></li>
          </ul>
          <form class="navbar-form navbar-right">
            <input type="text" class="form-control" placeholder="Search...">
          </form>
        </div>
      </div>
    </nav>

    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-3 col-md-2 sidebar">
          <ul class="nav nav-sidebar">
            <li class="active"><a href="#">권한관리 <span class="sr-only">(current)</span></a></li>
            <li><a href="#">롤관리</a></li>
            <li><a href="#">메뉴관리</a></li>
          </ul>
          <ul class="nav nav-sidebar">
            <li><a href="">사용자관리</a></li>
            <li><a href="">조직관리</a></li>
          </ul>
        </div>
        <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
          <h1 class="page-header">권한관리</h1>
		  <div data-ax5grid="first-grid" data-ax5grid-config="{}" style="height: 500px; width: 50%"></div>
        </div>
      </div>
    </div>
  </body>
</html>
<script type="text/javascript">
	
	var authorizationToken = getCookie("jwtToken");
	console.log("쿠키 저장된 값: "+ authorizationToken);

	var mask = new ax5.ui.mask();
	var modal = new ax5.ui.modal({
		header: {
            title: "<i class='fa fa-arrows' aria-hidden='true'></i> 타이틀",
            btns: {
              close: {
                label: '<i class="fa fa-times-circle" aria-hidden="true"></i> X',
                onClick: function() {
                  modal.close();
                }
              }
            }
        }
	});
	modal.setConfig({
	    onStateChanged: function(){
	        console.log(this);
	    }
	});
	
	$(document).ready(function() {
		$.ajaxSetup({
			contentType: "application/x-www-form-urlencoded; charset=utf-8",
			beforeSend: function (request)
            {
                request.setRequestHeader("Authorization", authorizationToken);
            }
		});
		
        var firstGrid = new ax5.ui.grid();
 
        firstGrid.setConfig({
            target: $('[data-ax5grid="first-grid"]'),
            columns: [
                {key: "authId", label: "권한ID"},
                {key: "authNm", label: "권한명"},
                {key: "description", label: "권한명"},
                {key: "createDt", label: "등록일시"},
                {
                	key: "", label: "롤정보", align: 'center', formatter: function() {
                		return '<button type="button"/>롤';
                	}
                }
            ]
        });
 
        // 그리드 데이터 가져오기
        $.ajax({
            method: "POST",            
            url: "/auth/selectAuthInfo",
            success: function (data, status, request) {
                firstGrid.setData(data.authList);
            }
        });
        
	})
	
	function testAction() {
		$.post(
			"/api/test",
			function(data, status, request) {
				alert(data);
			}
		);
	}
	
	function selectAllUser() {
		$.get(
			"/api/user/selectAllUser",
			function(data, status, request) {
				alert(data);
			}
		);
	}
	
	function goAuthPage() {
		location.href = "/static/html/auth.html";
	}
	
	function createAuthModal() {
		modal.open({
            width: 600,
            onStateChanged: function () {
                // mask
                if (this.state === "open") {
                    mask.open();
                }
                else if (this.state === "close") {
                    mask.close();
                }
            }
        }, function () {
        	var targetEl = this.$["body-frame"];
        	$.get("/static/html/auth/createAuth.html", function(data) {    	        
        		targetEl.append(data);
          	});
        });
	}
	
</script>