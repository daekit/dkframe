<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<link rel="icon" href="/static/favicon.ico"  type="image/x-icon">
</head>
<script type="text/javascript">
	
	$(document).ready(function() {
        getData();
	})
	
	function createRoleModal() {
		openModal("/static/html/admin/role/createRole.html", 600, 300, "메뉴등록");
	}
	
	function updateRoleModal() {
		if(selectGridValidation(firstGrid)) return;
		openModal("/static/html/admin/role/updateRole.html", 600, 300, "메뉴수정");
	}
	
	function deleteRole() {
		if(selectGridValidation(firstGrid)) return;
		if(!confirm("삭제하시겠습니까?")) return;
		var formData = {
				"menuId" : firstGrid.getList("selected")[0].menuId
		}
		deleteAjax("/admin/role/deleteRole", formData, null, function(){
			alert(data.resultMessage);
			getData();
		});
	}
	
	function getData() {
		postAjax("/admin/menu/selectMenuList", null, null, function(data){
			initMenuTree(data.menuList);
		});
	}

	function initMenuTree(menuList) {
		//checkbox plugin 속성
		//three_state : 부모노드 클릭 시 하위노드 체크
		//whole_node : 노드 클릭시 체크박스 컨트롤
		$("#menuTree").jstree({
			plugins: ['types', 'search', 'sort'],
		    core: {
		    	data: menuList
		    },
		    types : {
		        'unit': { 'icon': 'glyphicon glyphicon-folder-close'},
		        'unit-open'  : { 'icon': 'glyphicon glyphicon-folder-open'}
	      	},
	      	checkbox: {
		    	keep_selected_style : false,
		    	three_state : false,
		    	whole_node : true
		    },
		    search: {
		      	show_only_matches: false
		    },
		    sort: function(a, b){
		    	
		    }
		  	}).on("ready.jstree", function() {
		  		
		  	}).on("loaded.jstree", function() {
		  		
			}).on("refresh.jstree", function() {
			
			}).on("select_node.jstree", function (e, data) {
				var selected = data.node.original;
				$("#menuId").html(selected.id);
				$("#menuNm").html(selected.text);
				$("#upMenuId").html(selected.parent);
				$("#menuUrl").html(selected.url);
				$("#menuType").html(selected.menuType);
			}).on("deselect_node.jstree", function(e, data){
			// 노드가 선택해제 시 발생 이벤트
				
			}).on('open_node.jstree', function(e, data) {
			    data.instance.set_type(data.node,'unit-open');
			}).on('close_node.jstree', function(e, data) {
			    data.instance.set_type(data.node,'unit');
			});
	}
	
</script>
<body>
	<div class="row">
		<div class="col-xs-9">
			<span style="font-size: 22px; font-weight: bold;">메뉴관리</span>
			<div style="float: right;">
				<a href="#" class="btn btn-default btn-sm" id="registViewBtn">등록</a>
				<a href="#" class="btn btn-default btn-sm" id="modifyViewBtn">수정</a>
			</div>
		</div>
	</div>
	<div class="row" style="margin-top: 15px;">
		<div class="col-xs-3">
			<div id="menuTree"></div>
		</div>
		<div class="col-xs-6">
			<table class="table">
				<colgroup>
					<col style="width: 30%;">
					<col style="width: 70%">
				</colgroup>
				<tbody id="menuInfo">
					<tr>
						<th>메뉴ID</th>
						<td id="menuId"></td>
					</tr>
					<tr>
						<th>메뉴명</th>
						<td id="menuNm"></td>
					</tr>
					<tr>
						<th>부모메뉴ID</th>
						<td id="upMenuId"></td>
					</tr>
					<tr>
						<th>메뉴URL</th>
						<td id="menuUrl"></td>
					</tr>
					<tr>
						<th>메뉴타입</th>
						<td id="menuType"></td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>
</body>
</html>
